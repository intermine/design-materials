<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <title>FlyMine Tech Talk - Eclipse and Perl</title>
  <meta name="generator" content="S5" />
  <meta name="version" content="1.0" />
  <meta name="presdate" content="20041007" />
  <meta name="author" content="Kim Rutherford" />
  <meta name="company" content="FlyMine" />
  <link rel="stylesheet" href="ui/slides.css" type="text/css" media="projection" id="slideProj" />
  <link rel="stylesheet" href="ui/opera.css" type="text/css" media="projection" id="operaFix" />
  <link rel="stylesheet" href="ui/print.css" type="text/css" media="print" id="slidePrint" />
  <script src="ui/slides.js" type="text/javascript"></script>
</head>
<body>

  <div class="layout">
    <div id="currentSlide"></div>
    <div id="header"></div>
    <div id="footer">
      <div id="controls"></div>
    </div>
  </div>
  <div class="presentation">
    <div class="slide">
      <h1>Eclipse, SWT, JFace, RCP, Perl, Mason and Inline::Java</h1>
      <p>
        <ul>
          <li>Eclipse - an open, extensible platform for any application</li>
          <li>RCP - Rich Client Platform</li>
          <li>SWT - Standard Widget Toolkit</li>
          <li>JFace</li>
        </ul>
      </p>
      <p>
        <ul>
          <li>
            Perl
          </li>
          <li>
            Inline::Java
          </li>
          <li>
            Mason - JSP for Perl
          </li>
        </ul>
      </p>
    </div>

    <div class="slide">
      <h1>Eclipse</h1>
      <ul>
        <li>
          Previously - "Eclipse is a kind of universal tool platform - an open
          extensible IDE for anything and nothing in particular."
        </li>
        <li>
          Now - "Eclipse is an open, extensible platform for any application."
        </li>
        <li>
          An open source IDE framework
        </li>
        <li>
          Java/C++/C/Perl (+ ANT and others)
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Eclipse features</h1>
      <ul>
        <li>
          Open source and very extendable
        </li>
        <li>
          Based on plugins
          <ul>
            <li>
              Subversion
            </li>
            <li>
              Checkstyle
            </li>
          </ul>
        </li>
        <li>
          Flexible and configurable user interface
        </li>
        <li>
          Usual IDE stuff (editors, compiler, debugger)
        </li>
        <li>
          Syntax checking, hints and completion
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Eclipse screenshot</h1>
      <p>
        <img src="pix/eclispe_warning.gif" title="Eclipse example"/>
      </p>
    </div>

    <div class="slide">
      <h1>Eclipse code suggestions</h1>
      <p>
        <img src="pix/eclispe_suggest.gif" title="Eclipse example"/>
      </p>
    </div>

    <div class="slide">
      <h1>Eclipse debugging</h1>
      <p>
        <img src="pix/eclispe_debug_setup.gif" title="Eclipse example"/>
      </p>
    </div>

    <div class="slide">
      <h1>Eclipse debugging</h1>
      <p>
        <img src="pix/eclispe_debug_break.gif" title="Eclipse example"/>
      </p>
    </div>

    <div class="slide">
      <h1>Eclipse demo</h1>
      <ul>
        <li>
          Navigation and reading files
        </li>
        <li>
          Code suggestions
        </li>
        <li>
          Warnings and errors
        </li>
        <li>
          Quick fix
        </li>
        <li>
          Refactoring
        </li>
        <li>
          Perspectives
        </li>
        <li>
          Debugging
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Rich Client Platform - What is it?</h1>
      <ul>
        <li>
          The core of Eclipse, but not tied to it
        </li>
        <li>
          A platform for constructing applications
        </li>
        <li>
          "The minimal set of plug-ins needed to build a rich client
          application"
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>RCP - What is included?</h1>
      <ul>
        <li>
          User interface packages (SWT, JFace)
        </li>
        <li>
          Eclipse Runtime - infrastructure packages (for controlling and
          updating plugins, extensions, preferences, help)
        </li>
        <li>
          Workbench - dialogs and wizards for building a complete
          graphical application
        </li>
        <p>
          Users of the RCP packages can pick and choose what to use (although
          there are some dependences)
        </p>
      </ul>
    </div>

    <div class="slide">
      <h1>The workbench</h1>
      <ul>
        <li>
          The Workbench builds on top of the Runtime, SWT and JFace
        </li>
        <li>
          No IDE functionality
        </li>
        <li>
          Provides a scalable, open-ended, multi-window environment for managing views,
          editors, perspectives (task-oriented layouts), actions, wizards, preference
          pages
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Workbench - what is included?</h1>
      <p>
        <ul>
          <li>
            Help system - Web based help UI
          </li>
          <li>
            Update Manager - updated versions of products and extensions
          </li>
          <li>
            Text - Framework for building high-function text editors
          </li>
          <li>
            Splash screen
          </li>
        </ul>
      </p>
    </div>

    <div class="slide">
      <h1>Workbench example</h1>
      <p>
        <img src="pix/rcp_example2.jpg" title="Workbench example" height="600"
             width="800"/>
      </p>
    </div>

    <div class="slide">
      <h1>SWT - The Standard Widget Toolkit</h1>
      <ul>
        <li>
          Efficient, portable access to the user-interface facilities
        </li>
        <li>
          Provides:
          <ul>
            <li>
              Widgets
            </li>
            <li>
              User interface event handling (button presses, window resize
              etc.)
            </li>
            <li>
              Graphics primitives (text and images)
            </li>
          </ul>
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>AWT comparison</h1>
      <ul>
        <li>
          AWT uses only native widgets - native peers
        </li>
        <li>
          Least common denominator approach.
        </li>
        <li>
          Only has functionality that is available on all platforms
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Swing comparison</h1>
      <ul>
        <li>
          Swing only uses native widgets when necessary
        </li>
        <li>
          ie. top level windows (Frames)
        </li>
        <li>
          Same functionality is available on all platforms but look and feel
          isn't platform specific
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>SWT versus AWT and Swing</h1>
      <ul>
        <li>
          SWT uses native widgets where they exist
        </li>
        <li>
          Emulates those that don't
        </li>
        <li>
          Native look and feel on all platforms
        </li>
        <li>
          Fast (like AWT)
        </li>
        <li>
          Portable (like SWING)
        </li>
      </ul>

    <div class="slide">
      <h1>SWT Example</h1>
      <pre>
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class SimplestSWTExample {

   public static void main(String []args){
      Display display = new Display();
      Shell shell = new Shell(display);
      shell.setText("Simplest SWT Example");
      shell.pack();
      shell.open();
      while (!shell.isDisposed()){
         if (!display.readAndDispatch()){
            display.sleep();
         }
      }
      display.dispose();
   }
}
      </pre>
    </div>


    <div class="slide">
      <h1>Event loop</h1>
      <p>
        <pre>
while (!shell.isDisposed()){
   if (!display.readAndDispatch()){
      display.sleep();
   }
}
        </pre>
      </p>
      <p>
        Better control with less surprises
      </p>
    </div>



    <div class="slide">
      <h1>JFace</h1>
      <ul>
        <li>
          JFace - A UI framework, layered on top of SWT, for handling many common
          UI programming tasks.
        </li>
        <li>
          SWT is low level - frames, menus, buttons, events
        </li>
        <li>
          JFace is high level - dialogs, wizards and MVC (via "viewers")
        </li>
        <li>
          JFace does not try to "hide" SWT or replace its function.
        </li>
        <li>
          It provides classes and interfaces that handle many of the common
          tasks associated with programming a dynamic UI using SWT.
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl Summary</h1>
      <ul>
        <li>
          Uses ideas and syntax from Bourne shell, C Shell, AWK, SED, C, English, (Basic?) ...
        </li>
        <li>
          Perl is glue
        </li>
        <li>
          Perl is interpreted (sort-of)
        </li>
        <li>
          Perl is compiled (sort-of)
        </li>
        <li>
          Perl is (mostly) typeless
        </li>
        <li>
          "There is more than one way to do it"
        </li>
        <li>
          "The Swiss Army chain-saw of programming languages"
        </li>
        <li>
          "Perl makes easy jobs easy, and the hard jobs possible."
        </li>
        <li>
          "Practical Extraction and Report Language"
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl Features - part 1</h1>
      <ul>
        <li>
          Shallow learning curve (eg: $some_var = "hello world"; print "$some_var\n";)
        </li>
        <li>
          Few types: scalars, arrays, hashes, subroutines and references
        </li>
        <li>
          Legal type conversions are done automatically at run time; illegal
          type conversions are fatal errors
        </li>
        <li>
          Language support for regular expressions - lots of syntactic sugar
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl Features - part 2</h1>
      <ul>
        <li>
          Portable - available everywhere
        </li>
        <li>
          One-line-able and scriptable
        </li>
        <li>
          Procedural with functional bits (map and references to subroutines)
        </li>
        <li>
          Objected-orientated and modular programming as an option
        </li>
        <li>
          Reference counting for memory management
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Modules</h1>
      <p>
      The <a href="http://www.cpan.org">CPAN</a> archive contains thousands of modules
      </p>
      <p>
      <ul>
      </ul>
      <li>
        Widely used in bioinformatics - Bioperl
      </li>
      <li>
        CGI and web applications
      </li>
      <li>
        Parsing, reading and writing (eg. XML)
      </li>
      <li>
        Graphics (GD library used in GBrowse)
      </li>
      <li>
        Inline modules
      </li>
      </p>
    </div>

    <div class="slide">
      <h1>Perl syntax</h1>
      <ul>
        <li>
          From the Wikipedia:
          <p>
          "The overall structure of Perl derives broadly from C. Perl is a procedural
          programming language, with variables, expressions, assignment statements,
          brace-delimited code blocks, control structures, and subroutines."
          </p>
        </li>
        <li>
          <pre>
...

$count = 10;

while ($count > 0) {
  if ($count % 2 == 0) {
    print $count;
    print "\n"
  }
}

...
          </pre>
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl language</h1>
      <ul>
        <li>
          Perl takes associative arrays from AWK and regular expressions from SED
        </li>
        <li>
          Great for parsing and text handling
        </li>
        <li>
          <p>
            Language support for regular expressions.  eg.
          </p>
          <p>
            <pre>
if ($some_string =~ /fred (.*)/i) {
  print "Fred's surname: $1\n";
}
            </pre>
          </p>
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl syntax</h1>
      <ul>
        <li>
          In Perl 5, features were added that support complex data structures
          and an object oriented programming model
        </li>
        <li>
          References
        </li>
        <li>
          Packages/modules
        </li>
        <li>
          Classes and objects
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl Glue</h1>
      <p>
        Perl connects:
      </p>
      <p>
      <ul>
        <li>
          The filesystem
        </li>
        <li>
          Network - all socket and network functionality is available
        </li>
        <li>
          Operating system
          <ul>
            <li>
              system calls
            </li>
            <li>
              libraries (libc, almost anything from POSIX, modules)
            </li>
          </ul>
        </li>
        <li>
          C and other languages - extensions are often written in C
        </li>
        <li>
          Sub-processes (eg. <tt>open F, "ls|";</tt>)
        </li>
        <li>
          GUI - Tk/GTK/wxWidgets
        </li>
      </ul>
      </p>
    </div>

    <div class="slide">
      <h1>Deployment</h1>
      <ul>
        <li>
          One-liners
        </li>
        <li>
          Scripts
        </li>
        <li>
          Stand alone executables that include the Perl runtime
        </li>
        <li>
          CGI / mod_perl
        </li>
        <li>
          Embedded interpreter (used by mod_perl)
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>In-place Perl Example</h1>
      <p>
        Perl example - modify a file in-place
      </p>
      <pre>
perl -p -i.bak -e 's/foo/bar/g' *.txt
      </pre>
      <p>
        Meaning:
        <ul>
          <li>
loop over all *.txt
          </li>
          <li>
for each file rename some_file.txt to some_file.txt.bak
          </li>
          <li>
read from some_file.txt.bak
          </li>
          <li>
change each occurrence of "foo" to "bar" in every line
          </li>
          <li>
write to some_file.txt
          </li>
        </ul>
      </p>
    </div>

    <div class="slide">
      <h1>Longer Example - Data</h1>
<p>
  Names:
</p>
      <pre>
10001 Huey
10002 Louie
10003 Dewey
      </pre>
<p>
  Heights:
</p>
      <pre>
10001 50
10002 60
10005 65
      </pre>
    </div>

    <div class="slide">
      <h1>Longer Example - code</h1>
      <pre>
#!/usr/bin/perl

use strict;
use warnings;
use IO::All;

my %name_hash = ();

foreach my $line (io('names.txt')-&gt;slurp) {
  my ($id, $name) = split " ", $line;

  $name_hash{$id} = $name;
}

foreach my $line (io('heights.txt')-&gt;slurp) {
  my ($id, $height) = split " ", $line;

  die "no name for $id\n" unless exists $name_hash{$id};

  print "$id $name_hash{$id} $height\n";
}
      </pre>
    </div>

    <div class="slide">
      <h1>Example output</h1>
      <p>
      <pre>
merry (Work/perl)> ./simple_example.pl
10001 Huey 50
10002 Louie 60
no name for 10005
      </pre>
      </p>
    </div>

    <div class="slide">
      <h1>Perl Future</h1>
      <ul>
        <li>
          Perl 6
        </li>
        <li>
          Parrot
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Perl 6</h1>
      <ul>
        <li>
          Complete re-write
        </li>
        <li>
          Keep the best ideas and a lot of syntax
        </li>
        <li>
          Remove inconsistent, confusing and ambiguous syntax
        </li>
        <li>
          Add new features that are hard to implement in Perl 5
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Parrot</h1>
      <ul>
        <li>
          A virtual machine designed to execute bytecode for interpreted languages efficiently
        </li>
        <li>
          Main target is Perl 6
        </li>
        <li>
          Still in developement (so is Perl 6 though)
        </li>
        <li>
          Support for Python, Ruby, Scheme and TCL is planned
        </li>
        <li>
          Garbage collection (rather than reference counting) for memory management
        </li>
        <li>
          Register based rather than stack based
        </li>
      </ul>

    <div class="slide">
      <h1>Perl - Further information</h1>
      <ul>
        <li>
<a href="http://www.faqs.org/docs/pperl/pickingUpPerl_9.html">http://www.faqs.org/docs/pperl/pickingUpPerl_9.html</a>
        </li>
        <li>
<a href="http://www.faqs.org/docs/pperl/">http://www.faqs.org/docs/pperl/</a>
        </li>
        <li>
<a href="http://en.wikipedia.org/wiki/Perl">http://en.wikipedia.org/wiki/Perl</a>
        </li>
        <li>
<a href="http://www.perl.org">http://www.perl.org</a>
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Inline::C</h1>
      <p>Embed C in Perl programs:</p>
      <pre>
use Inline C =&gt; &lt;&lt;'END_C';
  void greet() {
    printf("Hello, world\n");
  }
END_C

greet;
      </pre>
      <p>
        Another example:
      </p>
      <pre>
use Inline C =&gt; &lt;&lt;'END_C';
  int times2(int a) {
    return a * 2;
  }
END_C

print &times2(8);
      </pre>
    </div>

    <div class="slide">
      <h1>Inline::Java</h1>
      <ul>
        <li>
          Embed Java code in a Perl program
        </li>
        <li>
          Call Java methods
        </li>
      </ul>
      <p>
        Example:
      </p>
      <p>
        <pre>
#!/usr/bin/perl
use strict;
use warnings;

use Inline Java =&gt; &lt;&lt;'EOJ';
   public class Hi {
      String greeting;
      public Hi(String greeting) {
          this.greeting = greeting;
      }
      public String getGreeting() {
         return greeting;
      }
   }
EOJ

my $greeter = new Hi("hello!");
print $greeter-&gt;getGreeting(), "\n";
        </pre>
      </p>
    </div>

    <div class="slide">
      <h1>Mason - JSP for Perl (sort of)</h1>
      <ul>
        <li>
A Perl-based web site development and delivery engine
        </li>
        <li>
A mechanism for embedding Perl code into plain text - a bit like PHP
        </li>
        <li>
A templating engine (of a sort)
        </li>
      </ul>
    </div>

    <div class="slide">
      <h1>Mason Example</h1>

      <p>
Embedding perl:
      </p>
      <pre>
&lt;html&gt;

% my $planet = "World";

Hello, &lt;% $planet %&gt;!

&lt;/html&gt;
      </pre>
      <p>
Output:
      </p>
      <pre>
Hello, World!
      </pre>

    </div>
    <div class="slide">
      <h1>Mason Example (SSI)</h1>
      <p>
Using mason as a glorified server-side include (SSI) mechanism:
      </p>
      <p>
Header (header.mas):
      </p>
      <pre>
  &lt;%args&gt;
   $head
  &lt;/%args&gt;

  &lt;html&gt;

  &lt;head&gt;&lt;title&gt;Welcome to Wally World!&lt;/title&gt;&lt;/head&gt;

  &lt;body bgcolor="#CCFFCC"&gt;

  &lt;center&gt;&lt;h1&gt;&lt;% $head %&gt;&lt;/h1&gt;&lt;/center&gt;
      </pre>
      <p>
Footer (footer.mas):
      </p>
      <pre>
  &lt;hr&gt;

  &lt;center&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/center&gt;

  &lt;/body&gt;&lt;/html&gt;
      </pre>
    </div>


    <div class="slide">
      <h1>Mason Example (SSI) continued ...</h1>
<p>
Main page:
</p>
<pre>
  &lt;&amp; header.mas, head => "Wally World Home" &amp;&gt;

  Here at Wally World you'll find all the finest accoutrements.

  &lt;&amp; footer.mas &amp;&gt;
</pre>
    </div>

    <div class="slide">
      <h1>Autohandlers</h1>
      <p>
        Alternatively, using the "autohandler" facility, pages will
        automatically be included in a template page.
      </p>

      <p>
        Example autohandler:
      </p>

      <pre>
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;
Flymine Website
    &lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
% $m-&gt;call_next;
  &lt;br&gt;
  &lt;/body&gt;
&lt;/html&gt;
    </div>

    <div class="slide">
      <h1>Inline::Java and Mason example</h1>

      <pre>

&lt;%args&gt;
  $iql_string =&gt; undef;
&lt;/%args&gt;

&lt;%perl&gt;
  use FlyMine::ObjectStoreWrapper;

  my $results;

  if (defined $iql_string) {
    $results = FlyMine::ObjectStoreWrapper-&gt;execute($iql_string);
  }
&lt;/%perl&gt;

&lt;form name="iql_form" method="post" action="/mt/iql"&gt;
  &lt;textarea name="iql_string" cols="80" rows="20"&gt;
&lt;% $iql_string | h %&gt;
  &lt;/textarea&gt;
  &lt;input type="submit" /&gt;
&lt;/form&gt;

% if (defined $iql_string) {
%   if (defined $results) {
  &lt;& results, results=&gt;$results &&gt;
%   } else {
  &lt;p&gt;no results&lt;/p&gt;
%   }
% }

      </pre>
    </div>

    <div class="slide">
      <h1>Results</h1>
      <pre>
&lt;table&gt;

% for (my $row_idx = 0; $row_idx &lt; $results-&gt;size; $row_idx++) {
%   my $row = $results-&gt;get($row_idx);
    &lt;tr&gt;

%   for (my $col_idx = 0; $col_idx &lt; $row-&gt;size; $col_idx++) {
%     my $obj = $row-&gt;get($col_idx);
      &lt;td&gt;

  &lt;%perl&gt;
    if (ref $obj) {
      print $obj-&gt;getId(), " ", ref $obj;
    } else {
      print $obj;
    }
  &lt;/%perl&gt;

      &lt;/td&gt;
%   }

    &lt;/tr&gt;
% }

&lt;/table&gt;

&lt;%args&gt;
$results
&lt;/%args&gt;
      </pre>
    </div>

    <div class="slide">
      <h1>FlyMine::ObjectStoreWrapper</h1>
<pre>
package FlyMine::ObjectStoreWrapper;

BEGIN {
  $ENV{PERL_INLINE_DIRECTORY} = '/tmp';
  $ENV{CLASSPATH} = 'intermine-mason.jar'
}

use Inline (Java =&gt; 'STUDY',
            STUDY =&gt; ['org.intermine.objectstore.ObjectStoreFactory',
                      'org.intermine.objectstore.query.iql.IqlQuery',
                     ],
            AUTOSTUDY =&gt; 1,
            PACKAGE =&gt; 'main'
           );

my $os = undef;

sub execute {
  my $self = shift;
  my $iql_string = shift;

  my $results = undef;

  if (!defined $os ) {
    $os = org::intermine::objectstore::ObjectStoreFactory-&gt;getObjectStore('os.unittest');
  }

  my $iql_query =
    new org::intermine::objectstore::query::iql::IqlQuery($iql_string,
                                                          'org.intermine.model.testmodel');

  $results = $os-&gt;execute($iql_query-&gt;toQuery());

  return $results;
}
</pre>
    </div>
</body>


</html>
